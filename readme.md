# Postman

## Concept
A Papers, Please inspired game where the player must validate and sort mail, adhereing to increasingly complex rules as time goes on. The story begins with the player going to the post office to forward mail to their new home in this town, when they offer to assist at the post office and become apprenticed .

The player is given the ability to open and re-seal all mail, althought they are expressly forbidden from doing so. Most mail is unreadable, but some story-driven mail is sent that the player can read. The player has the ability to send mail themselves. Initially, the options are meaningless, but reading certain story mail will open up new options. For example, after reading an incriminating letter, the player may choose to give an anonymous tip to the police.

The mail network is fully-simulated. Instead of randomly generating mail for the player to sort through, a list of senders randomly generate mail throughout the mail network every day. This adds many layers to the game. For example, the player may become familiar with the people in their town, may notice pairs of senders frequently replying to each other, etc. Mail the player sends to another town which is improperly addressed will be returned to the player marked "Undeliverable as addressed", for example.

In addition, a visualization of the map and all the mail in transit can be shown at the end of each day.

## Some Player-Facing Mechanics
The player will sort mail, either stamping it as undeliverable and putting it in the sender's box, or putting it in the recipient's box. If the recipient is in another town, the player will reference a map and forward the mail towards the post office of the appropriate town by putting it in the associated mailbox. The player will have to ensure the address is valid, that there is a stamp and that it is sufficient, that the mail is undamaged, and more. Sometimes, undeliverable mail doesn't have a return address. In these cases, the player will file the mail in the recovery bin. Mail in this bin may be subject to retrieval. For instance, a sender may submit a form requesting to recover lost mail at the player's post office. In this case, the player will search their local mail recovery bin for the post. If it isn't found, the player should forward the request to the post office that the mail being searched for would have been forwarded to.

These mechanics all become available to the player as they master previous ones. The pretext is that the postmaster will ask the player to set aside mail they don't know how to handle and will teach the player to handle more situations as the game progresses.

## Mail Simulation
The game world consists of towns. Each with a set of senders, who can generate new mail, and a post office (referred to as a mail router), which can route mail to local recipients or to other post offices. The player controls one of these mail routers.
Each day, every mail router (other than the player) will automatically sort mail according to the complete set of rules listed below and the mail will be delivered to the next step in the mail route. There is a small chance for each mail item handled to be handled improperly. Mail routed to the player will be added to their stack of mail to sort.

## Mail Generation
Mail is generated by senders and routed to their local post office until the amount of mail sent to the player meets two quotas:
The quota for the number of brand new mail that the player must sort, and
the quota for the total amount of mail the player must sort.
The ruleset of the day governs the type of mail randomly generated the morning prior to the player's workday. e.g., damaged mail is not generated the first day.

Step 1: Story mail generation
Pre-scripted mail is occasionally generated and sent to the player on certain days. Story mail will usually have readable content.

Step 2: Existing mail routed
Mail that was routed to the player by other post offices will appear in their queue.

Step 3: Random mail generation
At the beginning of each day, there is a minimum amount of new mail that must arrive for the player. New mail is generated by senders randomly and forwarded to the appropriate mail router (the sender's local post office) until the amount sent to the player's office meets this quota. There is an additional guota for the total amount of mail the player must have to sort for a day. If this quota is not met, mail generation will continue as before until it is.

The when a sender generates mail, they have a high chance of replying to a letter that was sent to them within the week prior.

# Implementation

## Rules
This is a WIP list of rules. Each day uses some set of them. If a rule is not in effect on a given day, mail matching that rule should be set aside.
For example, if the "Damaged mail must be repaired" rule is not in effect, the player should set aside damaged mail, not deliver it.

Mail must go to recipient: Valid mail must be placed in the recipient's box.
Mail must be routed appropriately: Valid mail not addressed to the player's town must be routed to the appropriate neighboring post office.
Mail must be stamped: Mail without a postal stamp must be RTS as "Postage Due"
Stamps must be sufficient: Mail with a stamp not appropriate for routing to another town must be RTS as "Postage shortpaid"
Damaged mail must be repaired: Damaged mail must be taped up.
Mail must be forwarded as requested: If post is addressed to a recipient's old address, a stamp must be placed to clarify the new address and the mail should be routed there.
Unreturnable mail must be placed in recovery: If mail must be returned to sender, but has no return address, it must be dated and placed in the mail recovery bin.

## Mail Routing
For simplicity, the network formed by the postal offices will always be simply-connected. This means that there is only one path between any two postal offices if backtracking is not allowed. This way, when mail must be routed from one office to another, there is always exactly one valid neighbor to route mail to.

## World Generation
The game world consists of towns, which have locations on the map and zip codes. Each town contains 3-8 streets, each of which has 4-12 homes, and each of those may have 1-3 senders. None of these components have actual locations on the map, they are simply used to generate coherent addresses shown on the mail. This is the alternative to randomly generating the addresses for each individual piece of post. Hopefully, this makes the world feel less abstract.

The player's town is generated with a few dozen senders. This number is designed so that the player comes to recognize their names over time. Four towns are generated within a disk around the player's town, and all are connected to the player's town. One of these four is very large (many senders), one is medium, and two are small. After that, six additional towns are randomly generated outside this disk, and each is connected to the nearest town (but never to the player's town). Each of these towns is in the small-to medium size range.